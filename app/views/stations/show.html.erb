<div class="row">
  <h1><%= @station.name %></h1>
  <% unless @station.user.nil? %>
      <p>Owned by <%= @station.user.email %></p>
  <% end %>
</div>


<div class="map-canvas small-12 large-12 columns no-fullscreen" data-lat="<%= @station.lat %>" data-lon="<%= @station.lon %>" id="map_canvas">
  <div class="marker hidden" data-lat="<%= @station.lat %>" data-lon="<%= @station.lon %>">
    <h3 class="title"><%= @station.name %></h3>
    <% if @station.measures? %>
        <% current_measure = @station.current_measure %>
        <div class="measure" data-direction="<%= current_measure.direction %>" data-speed="<%= current_measure.speed %>">
          <dl>Wind speed</dl>
        </div>
    <% end %>
  </div>
</div>

<article class="station row">

  <!-- Tabs containing  -->
  <dl class="tabs" data-tab>
    <% if @measures %>
    <dd class="active"><a href="#panel2-1">Chart</a></dd>
    <dd><a href="#panel2-2">Table</a></dd>
    <% end %>
    <dd><a href="#panel3-3">Meta</a></dd>
    <dd><a href="#panel4-4">Share!</a></dd>
  </dl>
  <div class="tabs-content">
    <% if @measures %>
    <section class="content row active small-12 large-12 columns" id="panel2-1">
      <div class="station-chart" id="station_measures_chart" data-path="<%= station_measures_path(@station) %>"></div>
    </section>
    <section class="content small-12 columns" id="panel2-2">
      <table class="measures small-12 columns">
        <thead>
        <th>Time</th>
        <th>Wind Speed</th>
        <th>Direction</th>
        <th>Max Wind Speed</th>
        <th>Min Wind Speed</th>
        </thead>
        <tbody>
        <% @measures.each do |measure| %>
            <%= render :partial => 'measures/measure', object: measure %>
        <% end %>
        </tbody>
      </table>
    </section>
    <% end %>
    <section class="content meta small-12 columns" id="panel3-3">
      <table class="small-12 columns">
        <tbody>
            <tr>
              <td>Created</td>
              <td><%= @station.created_at %></td>
            </tr>
            <% if @station.user.present? %>
            <tr>
              <dt>Owner</dt>
              <dd><%= @station.user.email %></dd>
            </tr>
            <% end %>
            <% if @station.measures? %>
            <tr>
              <td>Updated</td>
              <td><%= @station.current_measure.created_at %></td>
            </tr>
            <% end %>
            <tr>
              <td>Latitude</td>
              <td><%= @station.lat %></td>
            </tr>
            <tr>
              <td>Longitude</td>
              <td><%= @station.lon %></td>
            </tr>
        </tbody>
      </table>
    </section>
    <section class="content" id="panel4-4">
      <h3>Get embed code</h3>
      <textarea class="share-embed-code" style="width: 600px; height: 40px;" onkeydown="if ((event.ctrlKey || event.metaKey) &amp;&amp; event.keyCode == 67) { yt.tracking.track('embedCodeCopied'); }">&lt;iframe width="600" height="300" src="<%= embed_station_path @station %>" frameborder="0"&gt;&lt;/iframe&gt;</textarea>
      </p>
    </section>
  </div>



<% if can? :manage, Station %>
    <div class="admin-only btn-group">
      <%= link_to 'Edit', edit_station_path(@station), class: "button tiny" %>
      <%= link_to "Clear all measures for this station?", station_measures_path(@station),
                  :data => { :confirm =>  "Are you sure you want to delete all measues recorded by this station? This action cannot be undone!"  },
                  :class =>"tiny button alert", :method => :delete %>
    </div>
<% end %>
    <ul class="breadcrumbs" role="navigation">
      <li class="root"><a href="<%= root_path %>">Home</a></li>
      <li><a href="<%= stations_path %>">Stations</a></li>
      <li class="current"><a href="<%= station_path(@station) %>"><%= @station.name %></a></li>
    </ul>

</article>